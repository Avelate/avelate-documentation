# Connections

Серверне ядро утворене як совокупність окремих елементів, такими елементами є - сервер обчислень `server`, база данних `database` та глобальне сховище `memory storage`. Ядро, на найнижчому рівні, складається з з'єднувачів `connections` цих елементів системи.

| Назва | Модуль | Призначення |
| :---: | :--: | :---------- |
| Сервер обчислень | server.connection.ts | Виконує запити та здійснює логічні обчислення |
| База данних | database.connection.ts | Постійне місце зберігання данних |
| Глобальне сховище | memory-storage.connection.ts | Тимчасове місце зберігання даних |

> [!NOTE]
> Кожний елемент системи має методи `start` та `stop`, які описують ініціалізацію чи зупинку того чи іншого з'єднувача, завдяки чому є можливість явно задавати порядок ініціалізації та зупинки кожного з'єднувача `connections`.

<<SCHEMA>>



> [!TIP]
> При потребі в розробці додаткових елементів системи - вони можуть бути включені в необхідний момент
> ініціалізація того, чи іншого, вже існуючого, елемента системи. Розуміючи необхідні залежності від інших елементів системи,
> додаткові елементи - будуть включені в таку послідовність, при якій всі залежності вже повинні бути проініціалізовані.


## З'єднувачі елементів системи

Корінь серверної платформи влаштований з послідовно підключених елементів системи.
В цій послідовності, при ініціалізації платформи, будуть запущені чи зупинені елементи системи.
Якщо елементи були вибудовані в одному порядку для їх ініціалізації, то відключення відбувається рівно в протилежному порядку.

Елементами платформи на момент першого релізу є:
-  З'єднувач з базою даних `DatabaseConnection` – відповідає за запуск та закриття пулу з’єднань з базою даних.
-  З'єднувач з InMemory сховищем `InMemoryConnection` – відповідає за запуск та закриття з’єднання з InMemory сховищем.
-  З'єднувач з сервером `ServerConnection` – відповідає за запуск та зупинку сервера.

Через потребу створення явного порядку – кожен з'єднувач успадковується від абстрактного з’єднувача `AbstractConnection`,
потребує кожен з'єднувач реалізувати два методи – `start` та `stop`, таким чином, щоб в методі `start` була описана логіка
запуску відповідного з'єднувача, а в методі `stop` – зупинка цього з'єднувача.

**Загальний вид абстрактного з'єднувача:**

```typescript
@injectable()
abstract class AbstractConnection implements IAbstractConnection {
    protected abstract loggerService: ILoggerService

    public abstract start(): Promise<void>
    public abstract stop(): Promise<void>
}

export default AbstractConnection
```

> [!TIP]
> При потребі створення нових з'єднувачів в майбутніх релізах – ці з'єднувачі будуть також успадковуватись
> від абстрактного з’єднувача та будуть реалізовувати методи запуску та зупинки цих з'єднувачів.

## З'єднувач з базою даних

Створення екземпляра конкретної бази даних відбувається завдяки фабриці баз даних `DatabaseFactory`.
Деталі реалізації фабрики описано в розділі ["Фабрики елементів платформи"](server-platform/).

Оскільки з'єднувач є точкою ініціалізації з’єднання з базою даних, то з'єднувач є компонентом корневого рівня,
тому він має метод, в який фабрика записує екземпляр конкретної бази даних, і вже цей екземпляр запускається чи зупиняється
в рамках з’єднувача.

З'єднувач з базою даних запускається вже після того, як запуститься сервер з усіма залежностями. Оскільки для коректної
роботи фабрики бази даних, їй необхідний сервіс конфігурацій, який надається сервером, то екземпляр конкретної бази даних
створюється під час запуску сервера, це означає що екземпляр вже буде створений до того, як настане черга запуску
з’єднувача з базою даних.

# Issue

Необхідно створити функціонал для роботи з нереляційною базою даних – MongoDB.